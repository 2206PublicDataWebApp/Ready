<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="QuestionMapper">
	<resultMap type="Question" id="questionResultMap">
		<id property="queNo" 			column="QUE_NO"/>
		<result property="queWriter" 		column="QUE_WRITER"/>
		<result property="queTitle" 		column="QUE_TITLE"/>
		<result property="queContents" 		column="QUE_CONTENTS"/>
		<result property="queFilename" 		column="QUE_FILENAME"/>
		<result property="queFileRename" 	column="QUE_FILERENAME"/>
		<result property="queFilePath" 		column="QUE_FILEPATH"/>
		<result property="qEnrollDate" 		column="Q_ENROLL_DATE"/>
		<result property="qAnswer" 			column="Q_ANSWER"/>
		<result property="qStatus" 			column="Q_STATUS"/>
		<result property="qCategory" 		column="Q_CATEGORY"/>
	</resultMap>
	
	<insert id="insertFAQ">
		INSERT INTO QUESTION_TBL VALUES(SEQ_QUE_NO.NEXTVAL, #{queWriter}, #{queTitle}, #{queContents}
		, #{queFilename}, #{queFileRename}, #{queFilePath}, DEFAULT, #{qAnswer}, DEFAULT, #{qCategory})
	</insert>
	<!-- 고객센터에 문의한 문의글 보여줄 쿼리 -->
	<select id="selectTotalCount" resultType="_int">
		SELECT COUNT(*) FROM QUESTION_TBL
		<where>
			<if test="searchCondition.toString() == 'title'">
				QUE_TITLE LIKE '%'||#{searchValue}||'%'
			</if>
			<if test="searchCondition.toString() == 'contents'">
				QUE_CONTENTS LIKE '%'||#{searchValue}||'%'
			</if>
			<if test="searchCondition.toString() == 'all'">
				QUE_TITLE LIKE '%'||#{searchValue}||'%'
				OR QUE_CONTENTS LIKE '%'||#{searchValue}||'%'
			</if>
			AND Q_STATUS = 'N' OR Q_STATUS = 'Y'
		</where>
	</select>
	<select id="selectAllBoard" resultMap="questionResultMap">
		SELECT * FROM QUESTION_TBL WHERE Q_STATUS = 'N' OR Q_STATUS = 'Y' ORDER BY QUE_NO DESC
	</select>
	<!-- 내 문의글 갯수 -->
	<select id="selectMyCount" resultType="_int">
		SELECT COUNT(*) FROM QUESTION_TBL
		<where>
			<if test="searchCondition.toString() == 'title'">
				QUE_TITLE LIKE '%'||#{searchValue}||'%'
			</if>
			<if test="searchCondition.toString() == 'contents'">
				QUE_CONTENTS LIKE '%'||#{searchValue}||'%'
			</if>
			AND Q_STATUS = 'N' OR Q_STATUS = 'Y'
		</where>
	</select>
	<select id="selectMyBoard" resultMap="questionResultMap">
		SELECT * FROM QUESTION_TBL WHERE QUE_WRITER = #{queWriter} AND Q_STATUS = 'N' OR Q_STATUS = 'Y' ORDER BY QUE_NO DESC
	</select>
	<select id="selectOneByNo" resultMap="questionResultMap">
		SELECT * FROM QUESTION_TBL WHERE QUE_NO = #{queNo} AND Q_STATUS = 'N' OR Q_STATUS = 'Y'
	</select>
</mapper>