<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="MypageMapper">
  	<resultMap type="Survey" id="surveyResultMap">
  		<id 	property="userId" 		column="USER_ID"/>
  		<result property="answerGender" column="ANSWER_GENDER"/>
  		<result property="answerLove" 	column="ANSWER_LOVE"/>
  		<result property="answerHobby" 	column="ANSWER_HOBBY"/>
  		<result property="answerReason" column="ANSWER_REASON"/>
  		<result property="answerWriter" column="ANSWER_WRITER"/>
  		<result property="enrollDate" 	column="ENROLL_DATE"/>
  		<result property="updateDate" 	column="UPDATE_DATE"/>
  	</resultMap>
  	
  	<resultMap type="User" id="userResultMap">
  		<id		property="userIndex"				column="USER_INDEX"/>
  		<result	property="userId"					column="USER_ID"/>
  		<result	property="userPassword"				column="USER_PASSWORD"/>
  		<result	property="userName"					column="USER_NAME"/>
  		<result	property="userEmail"				column="USER_EMAIL"/>
  		<result	property="userPostcode"				column="USER_POSTCODE"/>
  		<result	property="userAddress"				column="USER_ADDRESS"/>
  		<result	property="userDetailAddress"		column="USER_DETAIL_ADDRESS"/>
  		<result	property="userPhone"				column="USER_PHONE"/>
  		<result	property="userNickname"				column="USER_NICKNAME"/>
  		<result	property="userPurchase"				column="USER_PURCHASE"/>
  		<result	property="userTier"					column="USER_TIER"/>
  		<result	property="userEnrollDate"			column="USER_ENROLL_DATE"/>
  		<result	property="userReserves"				column="USER_RESERVES"/>
  		<result	property="userBirthday"				column="USER_BIRTHDAY"/>
  		<result	property="userAge"					column="USER_AGE"/>
  		<result	property="userRole"					column="USER_ROLE"/>
  		<result	property="enabled"					column="ENABLED"/>
  		
  	</resultMap>
  		
  
	<insert id="InsertSurvey">
	  INSERT INTO SURVEY_TBL VALUES(#{userId }, #{answerGender }, #{answerLove }, #{answerHobby }, #{answerReason }, #{answerWriter }, DEFAULT, DEFAULT)
	</insert>
	
	<update id="updateMySurvey">
		UPDATE SURVEY_TBL SET ANSWER_GENDER = #{answerGender }, ANSWER_LOVE = #{answerLove }, ANSWER_HOBBY = #{answerHobby }, ANSWER_REASON = #{answerReason }, ANSWER_WRITER = #{answerWriter }, UPDATE_DATE = DEFAULT 
		WHERE USER_ID = #{userId }
	</update>
	  
	<select id="selectMySurvey" resultMap="surveyResultMap">
	  SELECT * FROM SURVEY_TBL WHERE USER_ID = #{userId}
	</select>
	
	<select id="selectOneUser" resultMap="userResultMap">
		SELECT * FROM USER_TBL WHERE USER_ID = #{userId}
	</select>
	
	<update id="updateUser">
		UPDATE USER_TBL SET USER_PASSWORD = #{userPassword }, USER_POSTCODE = #{userPostcode }, USER_ADDRESS = #{userAddress }, USER_DETAIL_ADDRESS = #{userDetailAddress}, USER_PHONE = #{userPhone}, USER_NICKNAME = #{userNickname }
		WHERE USER_ID = #{userId}
	</update>
	
	<select id="selectUserByNickname" parameterType="String" resultMap="userResultMap">
		SELECT * FROM USER_TBL WHERE USER_NICKNAME = #{userNickname} AND USER_ID != #{userId }
	</select>
  </mapper>